{"ast":null,"code":"//Home.js\nimport React,{useEffect,useState,useRef}from\"react\";import{Link}from\"react-router-dom\";import{getSessionCookie}from\"../auth/sessions\";import Logout from\"../LoginLogout/Logout\";import domainName from\"../../domain\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function Home(){const[user,setUser]=useState(\"\");const[email,setEmail]=useState(\"\");let effectCalled=useRef(false);const domain=domainName;useEffect(()=>{if(effectCalled.current){effectCalled.current=false;return;}try{fetch(\"\".concat(domain,\"/@me\"),{method:\"GET\",headers:{\"x-access-token\":getSessionCookie().token,\"ngrok-skip-browser-warning\":\"skip\"}}).then(response=>{if(response.status===200){return response.json();}else{return JSON.stringify({name:\"not logged in\",email:\" \"});}}).then(data=>{setUser(data.name);setEmail(data.email);});}catch(error){console.log(\"Not authenticated\");}effectCalled.current=true;},[]);return/*#__PURE__*/_jsx(\"div\",{children:user!=null?/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Logged in\"}),/*#__PURE__*/_jsxs(\"h3\",{children:[\"Logged in as: \",user]}),/*#__PURE__*/_jsxs(\"h3\",{children:[\"Email: \",email]}),/*#__PURE__*/_jsx(Link,{to:\"/Console\",children:/*#__PURE__*/_jsx(\"button\",{children:\"Console\"})}),/*#__PURE__*/_jsx(Logout,{setUser:setUser,setEmail:setEmail})]}):/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h2\",{children:\"You are not logged in\"}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(Link,{to:\"/login\",children:/*#__PURE__*/_jsx(\"button\",{children:\"Log In\"})}),/*#__PURE__*/_jsx(Link,{to:\"/register\",children:/*#__PURE__*/_jsx(\"button\",{children:\"Register\"})})]})]})});}export default Home;","map":{"version":3,"names":["React","useEffect","useState","useRef","Link","getSessionCookie","Logout","domainName","jsx","_jsx","jsxs","_jsxs","Home","user","setUser","email","setEmail","effectCalled","domain","current","fetch","concat","method","headers","token","then","response","status","json","JSON","stringify","name","data","error","console","log","children","to"],"sources":["/Users/davediemert/Repos/phlinger-frontend/src/Components/Home/Home.js"],"sourcesContent":["//Home.js\nimport React, { useEffect, useState, useRef } from \"react\";\nimport { Link } from \"react-router-dom\";\nimport { getSessionCookie } from \"../auth/sessions\";\nimport Logout from \"../LoginLogout/Logout\";\nimport domainName from \"../../domain\";\n\nfunction Home() {\n  const [user, setUser] = useState(\"\");\n  const [email, setEmail] = useState(\"\");\n  let effectCalled = useRef(false);\n  const domain = domainName;\n\n  useEffect(() => {\n    if (effectCalled.current) {\n      effectCalled.current = false;\n      return;\n    }\n    try {\n      fetch(`${domain}/@me`, {\n        method: \"GET\",\n        headers: {\n          \"x-access-token\": getSessionCookie().token,\n          \"ngrok-skip-browser-warning\": \"skip\",\n        },\n      })\n        .then((response) => {\n          if (response.status === 200) {\n            return response.json();\n          } else {\n            return JSON.stringify({\n              name: \"not logged in\",\n              email: \" \",\n            });\n          }\n        })\n        .then((data) => {\n          setUser(data.name);\n          setEmail(data.email);\n        });\n    } catch (error) {\n      console.log(\"Not authenticated\");\n    }\n    effectCalled.current = true;\n  }, []);\n  return (\n    <div>\n      {user != null ? (\n        <div>\n          <h2>Logged in</h2>\n          <h3>Logged in as: {user}</h3>\n          <h3>Email: {email}</h3>\n\n          <Link to=\"/Console\">\n            <button>Console</button>\n          </Link>\n\n          <Logout setUser={setUser} setEmail={setEmail} />\n        </div>\n      ) : (\n        <div>\n          <h2>You are not logged in</h2>\n          <div>\n            <Link to=\"/login\">\n              <button>Log In</button>\n            </Link>\n\n            <Link to=\"/register\">\n              <button>Register</button>\n            </Link>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n}\n\nexport default Home;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}